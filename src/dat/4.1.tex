In this section, another mathematical description of a focused laser beam based on a rigorous solution of the wave equation \ref{1.34} is presented. The following calculations are reproduced from the work of Illia Thiele et al. \cite{Thiele2016}. Assume that the laser beam propagates in vacuum without external sources along the z-axis of the Cartesian coordinate system. The wave equation \ref{1.34} in temporal Fourier space has the following form,
\begin{equation}
\label{4.1}
\laplace{\hat{\vec{E}}} \left(\vec{r}, \omega \right) + \frac{\omega^2}{c^2} \hat{\vec{E}} \left(\vec{r}, \omega \right) = 0,
\end{equation}
where the hat symbol placed on the top of a variable denotes the Fourier transform with respect to time. Next, one shall perform a spatial Fourier transform of \ref{4.1} with respect to transverse coordinates $ \vec{r_\bot} $ only,
\begin{equation}
\label{4.2}
\left(- k^2_x - k^2_y + \diffp[2]{}{z} \right) \bar{\vec{E}} \left(k_x, k_y, z, \omega \right) + \frac{\omega^2}{c^2} \bar{\vec{E}} \left(k_x, k_y, z, \omega \right) = 0,
\end{equation}
where the bar symbol placed on the top of a variable denotes the Fourier transform with respect to time and spatial transverse coordinates. The equation \ref{4.2} can be simplified as follows,
\begin{equation}
\label{4.3}
k^2_z \left(\vec{k}_\bot, \omega \right) \bar{\vec{E}}(\vec{k}_\bot, z, \omega) + \diffp[2]{}{z} \bar{\vec{E}} \left(\vec{k}_\bot, z, \omega \right) = 0.
\end{equation}
where $ k_z \left(\vec{k}_\bot, \omega \right) = \sqrt{-\vec{k}_\bot^2 + \omega^2/c^2} $ and $ \vec{k}_\bot = (k_x, k_y)^{\mathrm{T}} $. The fundamental solution of the equation \ref{4.3} consists of the forward $ (+) $ and backward $ (-) $ propagating waves,
\begin{equation}
\label{4.4}
\bar{\vec{E}}^{\pm} \left(\vec{k}_\bot, z, \omega \right) = \bar{\vec{E}}_{0}^{\pm} \left(\vec{k}_\bot, \omega \right) \e^{\pm \i k_z \left(\vec{k}_\bot, \omega \right) \left(z - z_0 \right)}.
\end{equation}
Where $ \bar{\vec{E}}_{0}^{\pm}\left(\vec{k}_\bot, \omega \right) $ is the electric laser field at some plane $ z = z_0 $. It might be clearly seen, that only two out of six vector components of the electric and magnetic fields are independent, therefore one may prescribe for example the transverse components $ \bar{\vec{E}}_{0, \bot}^{\pm}\left(\vec{k}_\bot, \omega \right) $ at the plane $ z = z_0 $ and all other components can be derived from the Maxwell's equations \ref{1.1}, \ref{1.3},
\begin{equation}
\label{4.5}
\bar{\vec{E}}^{\pm}_{\bot} \left(\vec{k}_\bot, z, \omega \right) = \bar{\vec{E}}^{\pm}_{0, \bot} \left(\vec{k}_\bot, \omega \right) \e^{\pm \i k_z \left(\vec{k}_\bot, \omega \right) \left(z - z_0 \right)},
\end{equation}
\begin{equation}
\label{4.6}
\bar{E}^{\pm}_z \left(\vec{k}_\bot, z, \omega \right) = \mp \frac{\vec{k}_\bot \cdot \bar{\vec{E}}^{\pm}_{\bot}(\vec{k}_\bot, z, \omega)}{k_z \left(\vec{k}_\bot, \omega \right)},
\end{equation}
\begin{equation}
\label{4.7}
\bar{\vec{B}}^{\pm}_{\bot} \left(\vec{k}_\bot, z, \omega \right) = \frac{1}{\omega k_z \left(\vec{k}_\bot, \omega \right)} \mathbb{R}^{\pm} \left(\vec{k}_\bot, \omega \right) \bar{\vec{E}}^{\pm} \left(\vec{k}_\bot, z, \omega \right),
\end{equation}
where
\begingroup
\renewcommand*{\arraystretch}{1.7}
\begin{equation}
\label{4.8}
\mathbb{R}^{\pm} \left(\vec{k}_\bot, \omega \right) =  \begin{pmatrix}
\mp k_x k_y & \mp \left[ k_z^2 \left(\vec{k}_\bot, \omega \right) + k_y^2 \right] & 0 \\
\pm \left[ k_z^2 \left(\vec{k}_\bot, \omega \right) + k_x^2 \right] & \pm k_x k_y & 0 \\
- k_y k_z \left(\vec{k}_\bot, \omega \right) & - k_x k_z \left(\vec{k}_\bot, \omega \right) & 0
\end{pmatrix}.
\end{equation} 
\endgroup

Analogically, one could solve the wave equation for the magnetic field \ref{1.35}, prescribe two transverse components of $ \bar{\vec{B}}_{0, \bot}^{\pm}\left(\vec{k}_\bot, \omega \right) $ at the plane $ z = z_0 $ and afterwards calculate all other fields using Maxwell's equations \ref{1.2}, \ref{1.4}. The complete proof, that the fields \ref{4.5} - \ref{4.7} are consistent with the Maxwell's equations in vacuum \ref{1.1} - \ref{1.4} can be found in the original paper \cite{Thiele2016}.

Note that for $ k_\bot^2 > \omega^2/c^2 $, $ k_z \left(\vec{k}_\bot, \omega \right) $ becomes imaginary and equation \ref{4.4} describes evanescent waves that are unphysical in free space. Thus the Fourier spectrum of laser waves has to be filtered in the transverse Fourier space. On the other hand, if the spatial Fourier spectrum contains only components with $ k_\bot^2 \ll \omega^2/c^2 $, then $ k_z \left(\vec{k}_\bot, \omega \right) $ can be approximated using the first few terms of a Taylor series,
\begin{equation}
\label{4.9}
k_z \left(\vec{k}_\bot, \omega \right) \approx \frac{\abs{\omega}}{c} - \frac{c}{2 \abs{\omega}} k_\bot^2.
\end{equation}
Note that by plugging \ref{4.9} into equations \ref{4.5} - \ref{4.7} one gets the paraxial approximation.

In the last part of this section, the practical algorithm for implementation of the boundary conditions based on the previously derived solution of the Maxwell's equations is presented. Assume that the laser beam propagates in a forward direction along the z-axis. In the beginning, it is necessary to prescribe the electric laser field $ \vec{E}_{0, \bot} (\vec{r}_{\bot}, t) $ in the plane $ \mathcal{P} $ at $ z = z_0 $. Note, that it can be defined by arbitrary function of space and time. The goal is then to find the fields $ \vec{E}_{\mathrm{B}} (\vec{r}_{\bot}, t) $ and $ \vec{B}_{\mathrm{B}} (\vec{r}_{\bot}, t) $ at the corresponding boundary $ z = z_\mathrm{B} $.

Consider that the transverse part of simulation domain is made of equidistant rectangular grid described by $ x^{i} $, $ y^{j} $, where $ i, j \in \left\lbrace 1, \ldots, N_{x, y} \right\rbrace $, and the grid steps $ \delta x $, $\delta y $. The simulation time $ t^{n} $, where $ n \in \left\lbrace 1, \ldots, N_{t} \right\rbrace $, is also divided into equidistant time steps of size $ \delta t $.

The algorithm allows to calculate fields $ \vec{E}_{\mathrm{B}}^{ij} (t) $ and $ \vec{B}_{\mathrm{B}}^{ij} (t) $ for any given time $ t $ from the interval $ \left[ t^{1} - \frac{z_\mathrm{B} - z_0}{c}, t^{N_t} - \frac{z_\mathrm{B} - z_0}{c} \right] $. In order to preserve clarity, the algorithm below is given in the exact form as in the original paper \cite{Thiele2016}.

\begin{enumerate}
	\item Calculate $ \hat{\vec{E}}_{0, \bot}^{ijn} $ via discrete Fourier transforms in time:
	\begin{equation}
	\omega^n = \frac{2 \pi}{N_t \delta t} \left( -\frac{N_t}{2} + n \right),
	\end{equation}
	\begin{equation}
	\hat{\vec{E}}_{0, \bot}^{ijn} = \frac{\delta t}{2 \pi} \sum_{l=1}^{N_t} \vec{E}_{0, \bot}^{ijl} \e^{\i \omega^n t^l}, \quad n \in \left\lbrace 1, \dots, N_t \right\rbrace.
	\end{equation}
	\item Calculate $ \bar{\vec{E}}_{0, \bot}^{ijn} $ via two-dimensional discrete Fourier transforms in transverse space:
	\begin{equation}
	k_x^i = \frac{2 \pi}{N_x \delta x} \left( - \frac{N_x}{2} + i\right), \quad k_y^j = \frac{2 \pi}{N_y \delta y} \left( - \frac{N_y}{2} + j\right),
	\end{equation}
	\begin{equation}
	\bar{\vec{E}}_{0, \bot}^{ijn} = \frac{\delta x \delta y}{(2 \pi)^2} \sum_{l, m = 1}^{N_x, N_y} \hat{\vec{E}}_{0, \bot}^{lmn} \e^{- \i \: \left(k_x^i x^l + k_y^j y^m \right)}, \quad i, j \in \left\lbrace 1, \dots, N_{x, y} \right\rbrace.
	\end{equation}
	\item Calculate transverse electric field components at the boundary $ z = z_\mathrm{B} $:
	\begin{equation}
	k_z^{ijn} = \Re \sqrt{\frac{(\omega^n)^2}{c^2} - (k_x^i)^2 - (k_y^j)^2},
	\end{equation}
	\begin{equation}
	\bar{\vec{E}}_{\mathrm{B}, \bot}^{ijn} =
	\begin{cases} \bar{\vec{E}}_{0, \bot}^{ijn} \e^{\i k_z^{ijn}(z_\mathrm{B} - z_0)} & \text{for} \ k_z^{ijn} > 0 \\ 0 & \text{for} \ k_z^{ijn} = 0 \end{cases}.
	\end{equation}
	\item Calculate longitudinal electric field components at the boundary $ z = z_\mathrm{B} $:
	\begin{equation}
	\bar{E}_{\mathrm{B}, z}^{ijn} = \begin{cases} -\frac{k_x^i \bar{E}_{\mathrm{B}, x}^{ijn} + k_y^j \bar{E}_{\mathrm{B}, y}^{ijn}}{k_z^{ijn}} & \text{for} \ k_z^{ijn} > 0 \\ 0 & \text{for} \ k_z^{ijn} = 0 \end{cases}.
	\end{equation}
	\item Calculate the magnetic field at the boundary $ z = z_\mathrm{B} $:
	\begingroup
	\renewcommand*{\arraystretch}{1.7}
	\begin{equation}
	\mathbb{R}^{ijn} =  \begin{pmatrix}
	-k_x^i k_y^j & (k_x^i)^2 - (\omega^n)^2/c^2 \\
	(\omega^n)^2/c^2 - (k_y^j)^2 & k_x^i k_y^j \\
	-k_y^j k_z^{ijn} & k_x^i k_z^{ijn} 
	\end{pmatrix},
	\end{equation} 
	\endgroup
	\begin{equation}
	\bar{\vec{B}}_{\mathrm{B}}^{ijn} = \begin{cases} (\omega^n k_z^{ijn})^{-1} \mathbb{R}^{ijn} \bar{\vec{E}}_{\mathrm{B}, \bot}^{ijn} & \text{for} \ k_z^{ijn} > 0 \\ 0 & \text{for} \ k_z^{ijn} = 0 \end{cases}.
	\end{equation}
	\item Calculate $ \hat{\vec{E}}_{\mathrm{B}}^{ijn} $, $ \hat{\vec{B}}_{\mathrm{B}}^{ijn} $ via two-dimensional inverse discrete Fourier transforms:
	\begin{equation}
	\hat{\vec{E}}_{\mathrm{B}}^{ijn} = \frac{(2 \pi)^2}{N_x N_y \delta x \delta y} \sum_{l, m = 1}^{Nx, Ny} \bar{\vec{E}}_{\mathrm{B}}^{lmn} \e^{\i(k_x^l x^i + k_y^m y^j)},
	\end{equation}
	\begin{equation}
	\hat{\vec{B}}_{\mathrm{B}}^{ijn} = \frac{(2 \pi)^2}{N_x N_y \delta x \delta y}  \sum_{l, m = 1}^{Nx, Ny} \bar{\vec{B}}_{\mathrm{B}}^{lmn} \e^{\i(k_x^l x^i + k_y^m y^j)}.
	\end{equation}
	\item Calculate $ \vec{E}_{\mathrm{B}}^{ij}(t) $, $ \vec{B}_{\mathrm{B}}^{ij}(t) $ for any given time $ t \in [t^{1} - \frac{z_{\mathrm{B}} - z_{0}}{c}, t^{N_{t}}  - \frac{z_{\mathrm{B}} - z_{0}}{c}] $.
	\begin{equation}
	\vec{E}_{\mathrm{B}}^{ij} (t) = \frac{2 \pi}{N_t \delta t} \sum_{n = 1}^{N_t} \hat{\vec{E}}_{\mathrm{B}}^{ijn} \e^{-\i \omega^n t},
	\end{equation}
	\begin{equation}
	\vec{B}_{\mathrm{B}}^{ij} (t) = \frac{2 \pi}{N_t \delta t} \sum_{n = 1}^{N_t} \hat{\vec{B}}_{\mathrm{B}}^{ijn} \e^{-\i \omega^n t}.
	\end{equation}
\end{enumerate}