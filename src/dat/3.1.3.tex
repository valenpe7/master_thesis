The behavior of computational particles is controlled by the Newton-Lorentz equations. Since the particles can reach velocities near the velocity of light, it is necessary to perform relativistic generalization,
\begin{equation}
\label{3.2.4.1}
\vec{u}_{p} = \gamma \, \vec{v}_{p}, \qquad \gamma = \sqrt{1 + \left( \frac{\vec{u}_{p}}{c}\right)^{2}}.
\end{equation}
Assume that the electric and magnetic fields are interpolated from the grid points to the particles at the time level $ t^{n} $. Then the computational particle equations of motion to be integrated are
\begin{equation}
\label{3.2.4.2}
\diff[]{\vec{x}_{p}}{t} = \frac{\vec{u}_{p}}{\gamma}, \qquad \diff[]{\vec{u}_{p}}{t} = \frac{q_{s}}{m_{s}} \left(\vec{E}_{p} + \frac{\vec{u}_{p}}{\gamma} \times \vec{B}_{p} \right).
\end{equation}
To discretize equations of motion (\ref{3.2.4.2}) a time-centered leap-frog scheme is used. One obtains
\begin{equation}
\label{3.2.4.4}
\frac{\vec{x}_{p}^{\:n+1} - \vec{x}_{p}^{\:n}}{\Delta t} = \frac{\vec{u}_{p}^{\:n + 1/2}}{\gamma^{\:n+1/2}},
\end{equation}
\begin{equation}
\label{3.2.4.5}
\frac{\vec{u}_{p}^{\:n+1/2} - \vec{u}_{p}^{\:n-1/2}}{\Delta t} = \frac{q_{s}}{m_{s}} \left( \vec{E}_{p}^{\:n} + \frac{\vec{u}_{p}^{\:n+1/2} + \vec{u}_{p}^{\:n-1/2}}{2 \gamma^{\:n}} \times \vec{B}_{p}^{\:n} \right).
\end{equation}

Although these equations appear to be very simple, the solution is the most time-consuming part of the simulation, because they have to be solved for every single computational particle. Standard for particle pushing in plasma simulation PIC codes is elegant Boris method, which completely separates the effect of electric and magnetic fields \cite{birdsall}. Substitute
\begin{equation}
\label{3.2.4.6}
\vec{u}_{p}^{\:n-1/2} = \vec{u}_{p}^{\:-} - \frac{q_{s} \vec{E}_{p}^{\:n}}{m_{s}} \frac{\Delta t}{2}, \qquad \vec{u}_{p}^{\:n+1/2} = \vec{u}_{p}^{\:+} + \frac{q_{s} \vec{E}_{p}^{\:n}}{m_{s}} \frac{\Delta t}{2}
\end{equation}
into equation (\ref{3.2.4.5}), then the electric field cancels entirely,
\begin{equation}
\label{3.2.4.7}
\frac{\vec{u}_{p}^{\:+} - \vec{u}_{p}^{\:-}}{\Delta t} = \frac{q_{s}}{2 \gamma^{\:n} m_{s}} \left(\vec{u}_{p}^{\:+} + \vec{u}_{p}^{\:-}\right)\times \vec{B}_{p}^{\:n}. 
\end{equation}
Equation (\ref{3.2.4.7}) describes a rotation of vector $ \vec{u}_{p}^{\:-} $ to $ \vec{u}_{p}^{\:+} $ in one simulation time step $ \Delta t $. The angle $ \theta $ between vector $ \vec{u}_{p}^{\:-} $ and $ \vec{u}_{p}^{\:+} $ we expect to be $ \theta = \omega_{c} \Delta t $.

To implement the Boris method, first add half the electric impulse $ \vec{E}_{p}^{\:n} $ to $ \vec{u}_{p}^{\:n-1/2} $, then perform the full rotation by the angle $ \theta $, and finally, add another half the electric impulse $ \vec{E}_{p}^{n} $. From the basic geometry Boris derived following steps to obtain $ \vec{u}_{p}^{\:n + 1/2} $. From the first of equations (\ref{3.2.4.6}) express vector $ \vec{u}_{p}^{\:-} $,
\begin{equation}
\vec{u}_{p}^{\:-} = \vec{u}_{p}^{\:n-1/2} +  \frac{q_{s} \vec{E}_{p}^{\:n}}{m_{s}} \frac{\Delta t}{2}
\end{equation}
and construct an auxiliary vector $ \vec{u}_{p}\!' $, which is simultaneously perpendicular to $ \left(\vec{u}_{p}^{\:+} - \vec{u}_{p}^{\:-} \right) $ and to $ \vec{B}_{p}^{\:n} $,
\begin{equation}
\vec{u}_{p}\!' = \vec{u}_{p}^{\:-} + \vec{u}_{p}^{\:-} \times \vec{t}, \qquad \vec{t} = \frac{q_{s} \vec{B}_{p}^{\:n} \Delta t}{2 \gamma^{\:n} m_{s}}.
\end{equation}
Vector $ \vec{t} $ has to be logically parallel to $ \vec{B}_{p}^{n} $ with the length of $ \tan \left(\theta/2\right) \approx \theta/2 $ for small angles. Next, utilize the fact that the vector $ (\vec{u}_{p}\!' \times \vec{B}_{p}^{\:n}) $ is parallel to $ \left(\vec{u}_{p}^{\:+} - \vec{u}_{p}^{\:-} \right) $ and express $ \vec{u}_{p}^{\:+} $,
\begin{equation}
\vec{u}_{p}^{\:+} = \vec{u}_{p}^{\:-} + \vec{u}_{p}\!' \times \vec{s}, \qquad \vec{s} = \frac{2\vec{t}}{1 + t^2}.
\end{equation}
Here vector $ \vec{s} $ is parallel to $ \vec{B}_{p}^{n} $ and its length has to fulfill the condition $ \norm{\vec{u}_{p}^{\:+}} = \norm{\vec{u}_{p}^{\:-}} $. The transition from $ \vec{u}_{p}^{\:-} $ to $ \vec{u}_{p}^{\:+} $ can be written more clearly using the matrix,
\begingroup
\renewcommand*{\arraystretch}{1.8}
\begin{equation}
\vec{u}_{p}^{\:+} =  \begin{pmatrix}
  1 - s_{2}t_{2} - s_{3}t_{3} & s_{2}t_{1} + s_{3} & s_{3}t_{1} - s_{2} \\
  s_{1}t_{2} - s_{3} & 1 - s_{1}t_{1} - s_{3}t_{3} & s_{3}t_{2} + s_{1} \\
  s_{1}t_{3} + s_{2} & s_{2}t_{3} - s_{1} & 1 - s_{1}t_{1} - s_{2}t_{2}
 \end{pmatrix}
\vec{u}_{p}^{\:-}.
\end{equation}
\endgroup
Finally, substitute vector $ \vec{u}_{p}^{\:+} $ into the second from the equations (\ref{3.2.4.6}),
\begin{equation}
\vec{u}_{p}^{\:n+1/2} = \vec{u}_{p}^{\:+} + \frac{q_{s} \vec{E}_{p}^{\:n}}{m_{s}} \frac{\Delta t}{2}.
\end{equation}
The position of computational particle is advanced according to
\begin{equation}
\vec{x}_{p}^{\:n+1} = \vec{x}_{p}^{\:n} + \frac{\vec{u}_{p}^{\:n + 1/2}}{\gamma^{\:n + 1/2}} \Delta t, \qquad \gamma^{\:n + 1/2} = \sqrt{1 + \left(\frac{\vec{u}_{p}^{\:n + 1/2}}{c}\right)^{2}}.
\end{equation}


