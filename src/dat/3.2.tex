The abbreviation EPOCH refers to an Extendable PIC Open Collaboration project \cite{bennett}. EPOCH is a multi-dimensional, relativistic, electromagnetic code designed for plasma physics simulations based on the PIC method. The code, which has been developed at University of Warwick, is written in FORTRAN and parallelized using MPI library. EPOCH is explicit and is able to achieve second-order accuracy. The entire core of the code uses SI units.

The main features include dynamic load balancing option for making optimal use of all processors when run in parallel, allowing restart on an arbitrary number of processors. The setup of EPOCH is controlled through a customizable input deck. An input deck is a text file which can be used to set simulation parameters for EPOCH without necessity to edit or recompile the source code. Most aspects of a simulation can be controlled, such as the number of grid points in the simulation domain, the initial distribution of particles and the initial electromagnetic field configuration. In addition, EPOCH has been written to add more modern features and to structure the code in such a way that the future expansion of the code may be made as easily as possible.

By default, EPOCH uses triangular particle shape functions with the peak located at the position of computational particle and a width of two cells, which provides relatively clean and fast solution. However, user can select higher order particle shape functions based on a spline interpolation by enabling compile-time option in the makefile.

The electromagnetic field solver uses a FDTD scheme with second order of accuracy. The field components are spatially staggered on a standard Cartesian Yee cell. The solver is directly based on the scheme derived by Hartmut Ruhl \cite{ruhl}. The particle pusher is relativistic, Birdsall and Landon type \cite{birdsall} and uses Villasenor and Buneman current weighting \cite{villasenor}.

EPOCH offers several types of boundary conditions for fields and particles, such as periodic, transmissive, reflecting and also Convolutional Perfectly Matched Layer (CPML) boundary conditions. Laser beams can be attached to arbitrary boundary via special boundary condition as well.

As a side project within this work, the code EPOCH has been instrumented to enable in situ diagnostics and visualization of the electromagnetic fields using ParaView Catalyst [source].
The increasing demands of the simulations need more data to be stored on a disk and analysed. However, the capabilities of computing environment which is responsible for transferring the data and communication have not grown up as rapid as the computational power. Dumping and processing of all the data calculated during the simulation would take too much time, so in practice this usually means that they are stored only at several time steps or at much coarser resolution than the original data. The rest is just discarded and the significant part of information may be potentially lost.

In situ visualization describes techniques where data can be visualized in real-time as it is generated during a simulation and without it being stored on a storage resource. By coupling the visualization and simulation, the data transfer bottleneck can be overcome. Furthermore, this approach allows scientists to monitor and interact with a running simulation, allowing for its parameters to be modified and allowing to immediately view the effects of these changes.

While a simulation is running, a user can see the size of the datasets that a simulation produces. But none of this data is physically stored on a storage system. The computationally expensive operations are carried out using ParaViewâ€™s graphical interface. So, the user can select data structures and analyze them in the same way as in post-processing, which requires the saving of datasets onto a file system. But there is one difference, the simulation is in progress so a user can observe the data as it is being generated. With Catalyst, it is also possible to pause the simulation or specify a break-point at a selected time step. This can be helpful if a user expects some interesting behavior of investigated phenomena or for identifying regions where numerical instability arises. For the implementation details, see Appendix - .

The main goal of this work has been to implement a solution that would enable to simulate tightly focused laser beams using simulation code EPOCH. This will be closer described in the following chapter.

